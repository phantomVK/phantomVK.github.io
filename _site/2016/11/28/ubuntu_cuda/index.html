<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="phantomvk">
    <meta name="google-site-verification" content="IQE3DCunv_AJ4WcB3TEdMLLJ73BqtvTmSrGN4cGVcYg" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Android,phantomvk,Android技术博客,Android源码分析,Android源码剖析">
    <meta name="keywords"  content="Android,phantomvk,Android技术博客,Android源码分析,Android源码剖析">
    <meta name="theme-color" content="#000000">
    <title>深度学习环境配置: Ubuntu16.04 & CUDA8.0 - phantomVK 博客</title>
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="canonical" href="http://localhost:4000/2016/11/28/ubuntu_cuda/">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/hux-blog.min.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
</head>

<body ontouchstart="">
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">phantomVK</a>
        </div>
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="/">Home</a></li>
                    
                    <li><a href="/about/">About</a></li>
                    <li><a href="/archives/">Archives</a></li>
                    <li><a href="/tags/">Tags</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>
<script>
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');
    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            setTimeout(function(){
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>
    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/main_img.jpg')
    }

    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Tools" title="Tools">Tools</a>
                        
                    </div>
                    <h1>深度学习环境配置: Ubuntu16.04 & CUDA8.0</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by phantomVK on November 28, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">
				<p>深度学习系统用Ubuntu 16.04，显卡是一张nVidia GTS450，主要用来做简单实验。用比较新的nVidia显卡驱动和CUDA8。</p>

<p><strong>请看完文章再尝试哦</strong></p>

<h1 id="添加下载源">添加下载源</h1>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">cd</span> /etc/apt/
<span class="gp">$ </span>sudo cp sources.list sources.list.bak
<span class="gp">$ </span>sudo vi sources.list 
</code></pre>
</div>

<p>把源添加到文件前面，保存</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>deb http://mirrors.ustc.edu.cn/ubuntu/ xenial main restricted universe multiverse
deb http://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiverse
deb http://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
deb http://mirrors.ustc.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse
deb http://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial main restricted universe multiverse
deb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiverse
deb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
deb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse
deb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse 
</code></pre>
</div>

<p>更新一下</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apt-get update
<span class="gp">$ </span>sudo apt-get upgrade
</code></pre>
</div>

<p>添加显卡驱动的PPA</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo add-apt-repository ppa:graphics-drivers/ppa
</code></pre>
</div>

<p>然后显示下列信息</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>Fresh drivers from upstream, currently shipping Nvidia.

<span class="c">## Current Status</span>

Current official release: <span class="sb">`</span>nvidia-370<span class="sb">`</span> <span class="o">(</span>370.28<span class="o">)</span>
Current long-lived branch release: <span class="sb">`</span>nvidia-367<span class="sb">`</span> <span class="o">(</span>367.57<span class="o">)</span>

For GeForce 8 and 9 series GPUs use <span class="sb">`</span>nvidia-340<span class="sb">`</span> <span class="o">(</span>340.98<span class="o">)</span>
For GeForce 6 and 7 series GPUs use <span class="sb">`</span>nvidia-304<span class="sb">`</span> <span class="o">(</span>304.132<span class="o">)</span>

<span class="c">## What we're working on right now:</span>

- Normal driver updates
- Help Wanted: Mesa Updates <span class="k">for </span>Intel/AMD users, ping us <span class="k">if </span>you want to <span class="nb">help </span><span class="k">do </span>this work, we<span class="s1">'re shorthanded.

## WARNINGS:

This PPA is currently in testing, you should be experienced with packaging before you dive in here:

Volunteers welcome! See also: https://github.com/mamarley/nvidia-graphics-drivers/

### How you can help:

## Install PTS and benchmark your gear:

    sudo apt-get install phoronix-test-suite

Run the benchmark:

    phoronix-test-suite default-benchmark openarena xonotic tesseract gputest unigine-valley

and then say yes when it asks you to submit your results to openbechmarking.org. Then grab a cup of coffee, it takes a bit for the benchmarks to run. Depending on the version of Ubuntu you'</span>re using it might preferable <span class="k">for </span>you to grabs PTS from upstream directly: http://www.phoronix-test-suite.com/?k<span class="o">=</span>downloads

<span class="c">## Share your results with the community:</span>

Post a link to your results <span class="o">(</span>or any other feedback to<span class="o">)</span>: https://launchpad.net/~graphics-drivers-testers

Remember to rerun and resubmit the benchmarks after driver upgrades, this will allow us to gather a bunch of data on performance that we can share with everybody.

If you run into old documentation referring to other PPAs, you can <span class="nb">help </span>us by consolidating references to this PPA.

If someone wants to go ahead and start prototyping on <span class="sb">`</span>software-properties-gtk<span class="sb">`</span> on what the GUI should look like, please start hacking!

<span class="c">## Help us Help You!</span>

We use the donation funds to get the developers hardware to <span class="nb">test </span>and upload these drivers, please consider donating to the <span class="s2">"community"</span> slider on the donation page <span class="k">if </span>you<span class="s1">'re loving this PPA:

http://www.ubuntu.com/download/desktop/contribute
 More info: https://launchpad.net/~graphics-drivers/+archive/ubuntu/ppa
Press [ENTER] to continue or ctrl-c to cancel adding it
</span></code></pre>
</div>

<p>在这里回车确认</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>gpg: keyring <span class="sb">`</span>/tmp/tmp_4l44wuj/secring.gpg<span class="s1">' created
gpg: keyring `/tmp/tmp_4l44wuj/pubring.gpg'</span> created
gpg: requesting key 1118213C from hkp server keyserver.ubuntu.com
gpg: /tmp/tmp_4l44wuj/trustdb.gpg: trustdb created
gpg: key 1118213C: public key <span class="s2">"Launchpad PPA for Graphics Drivers Team"</span> imported
gpg: Total number processed: 1
gpg:               imported: 1  <span class="o">(</span>RSA: 1<span class="o">)</span>
OK
</code></pre>
</div>

<p>下面就可以开始安装显卡驱动了，下载速度有点慢。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apt-get update
<span class="gp">$ </span>sudo apt-get install nvidia-367
<span class="gp">$ </span>sudo apt-get install mesa-common-dev
<span class="gp">$ </span>sudo apt-get install freeglut3-dev 
</code></pre>
</div>

<p>驱动安装完成一定要重启系统</p>

<h1 id="下载并安装cuda">下载并安装CUDA</h1>

<p>进入<a href="https://developer.nvidia.com/cuda-release-candidate-download">CUDA官网</a>，注册并登陆账号，按照下图配置下载Ubuntu的安装文件，文件约1.4GB。</p>

<p><img src="/img/cuda.png" alt="img" /></p>

<p>下载完成进入下载目录，创建一个临时文件，使用命令解压到临时文件中并安装。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo mkdir /opt/temp
<span class="gp">$ </span>sudo sh cuda_8.0.44_linux.run --tmpdir<span class="o">=</span>/opt/temp/ 
</code></pre>
</div>

<p>安装协议可以使用<code class="highlighter-rouge">q</code>跳过，显示第一个问题询问是否安装驱动。因为前面我们已经安装了驱动，所以我们不安装。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>....
....

Do you accept the previously <span class="nb">read </span>EULA?
accept/decline/quit:accept

Install NVIDIA Accelerated Graphics Driver <span class="k">for </span>Linux-x86_64 367.48?
<span class="o">(</span>y<span class="o">)</span>es/<span class="o">(</span>n<span class="o">)</span>o/<span class="o">(</span>q<span class="o">)</span>uit: n
</code></pre>
</div>

<p>有问题就选择<code class="highlighter-rouge">y</code>，询问路径就回车默认设置。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>Install the CUDA 8.0 Toolkit?
<span class="o">(</span>y<span class="o">)</span>es/<span class="o">(</span>n<span class="o">)</span>o/<span class="o">(</span>q<span class="o">)</span>uit: y

Enter Toolkit Location
 <span class="o">[</span> default is /usr/local/cuda-8.0 <span class="o">]</span>: y

Toolkit location must be an absolute path.
Enter Toolkit Location
 <span class="o">[</span> default is /usr/local/cuda-8.0 <span class="o">]</span>: 

Do you want to install a symbolic link at /usr/local/cuda?
<span class="o">(</span>y<span class="o">)</span>es/<span class="o">(</span>n<span class="o">)</span>o/<span class="o">(</span>q<span class="o">)</span>uit: y

Install the CUDA 8.0 Samples?
<span class="o">(</span>y<span class="o">)</span>es/<span class="o">(</span>n<span class="o">)</span>o/<span class="o">(</span>q<span class="o">)</span>uit: y

Enter CUDA Samples Location
 <span class="o">[</span> default is /home/mike <span class="o">]</span>: 

Installing the CUDA Toolkit <span class="k">in</span> /usr/local/cuda-8.0 ...
</code></pre>
</div>

<p>在这里根据不同系统会有2个或4个文件缺失。我的缺了两个文件。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Missing recommended library: libXi.so
Missing recommended library: libXmu.so
</code></pre>
</div>

<p>使用apt补一下，参考自 <a href="http://stackoverflow.com/questions/22360771/missing-recommended-library-libglu-so">stackoverflow</a>。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apt-get install nvidia-modprobe freeglut3-dev libx11-dev libxmu-dev libxi-dev libglu1-mesa-dev
</code></pre>
</div>

<p>安装完成要<code class="highlighter-rouge">重启系统</code>，然后再重新安装CUDA包。因为我在这里掉坑了，所谓我建议你们先看文章再尝试。正常的话就不会在显示文件缺失，然后安装成功。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>Installing the CUDA Samples <span class="k">in</span> /home/textminer ...
Installing the CUDA Samples <span class="k">in</span> /home/mike ...
Copying samples to /home/mike/NVIDIA_CUDA-8.0_Samples now...
Finished copying samples.

<span class="o">===========</span>
<span class="o">=</span> Summary <span class="o">=</span>
<span class="o">===========</span>

Driver:   Not Selected
Toolkit:  Installed <span class="k">in</span> /usr/local/cuda-8.0
Samples:  Installed <span class="k">in</span> /home/mike, but missing recommended libraries

Please make sure that
 -   PATH includes /usr/local/cuda-8.0/bin
 -   LD_LIBRARY_PATH includes /usr/local/cuda-8.0/lib64, or, add /usr/local/cuda-8.0/lib64 to /etc/ld.so.conf and run ldconfig as root

To uninstall the CUDA Toolkit, run the uninstall script <span class="k">in</span> /usr/local/cuda-8.0/bin

Please see CUDA_Installation_Guide_Linux.pdf <span class="k">in</span> /usr/local/cuda-8.0/doc/pdf <span class="k">for </span>detailed information on setting up CUDA.

<span class="k">***</span>WARNING: Incomplete installation! This installation did not install the CUDA Driver. A driver of version at least 361.00 is required <span class="k">for </span>CUDA 8.0 functionality to work.
To install the driver using this installer, run the following <span class="nb">command</span>, replacing &lt;CudaInstaller&gt; with the name of this run file:
    sudo &lt;CudaInstaller&gt;.run -silent -driver

Logfile is /opt/temp//cuda_install_2299.log
</code></pre>
</div>

<p>安装完毕后声明一下环境变量，并将其写入到<code class="highlighter-rouge">~/.bashrc</code>的最后</p>

<div class="highlighter-rouge"><pre class="highlight"><code>export PATH=/usr/local/cuda-8.0/bin${PATH:+:${PATH}}export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}} 
</code></pre>
</div>

<h1 id="测试">测试</h1>

<p>使用<code class="highlighter-rouge">nvidia-smi</code>检查显卡状况。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">mike@mike-P5Q-PRO:~/NVIDIA_CUDA-8.0_Samples$ </span>nvidia-smi
Fri Nov 25 17:07:01 2016
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 367.57                 Driver Version: 367.57                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|<span class="o">===============================</span>+<span class="o">======================</span>+<span class="o">======================</span>|
|   0  GeForce GTS 450     Off  | 0000:01:00.0     N/A |                  N/A |
| 40%   35C   P12    N/A /  N/A |    225MiB /   962MiB |     N/A      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|<span class="o">=============================================================================</span>|
|    0                  Not Supported                                         |
+-----------------------------------------------------------------------------+
</code></pre>
</div>

<p>测试显卡带宽，使用之前先把文件用<code class="highlighter-rouge">make</code>编译一下！</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">mike@mike-P5Q-PRO:~/NVIDIA_CUDA-8.0_Samples/1_Utilities/bandwidthTest$ </span>./bandwidthTest 
<span class="o">[</span>CUDA Bandwidth Test] - Starting...
Running on...

 Device 0: GeForce GTS 450
 Quick Mode

 Host to Device Bandwidth, 1 Device<span class="o">(</span>s<span class="o">)</span>
 PINNED Memory Transfers
   Transfer Size <span class="o">(</span>Bytes<span class="o">)</span>	Bandwidth<span class="o">(</span>MB/s<span class="o">)</span>
   33554432			5390.0

 Device to Host Bandwidth, 1 Device<span class="o">(</span>s<span class="o">)</span>
 PINNED Memory Transfers
   Transfer Size <span class="o">(</span>Bytes<span class="o">)</span>	Bandwidth<span class="o">(</span>MB/s<span class="o">)</span>
   33554432			5935.1

 Device to Device Bandwidth, 1 Device<span class="o">(</span>s<span class="o">)</span>
 PINNED Memory Transfers
   Transfer Size <span class="o">(</span>Bytes<span class="o">)</span>	Bandwidth<span class="o">(</span>MB/s<span class="o">)</span>
   33554432			43900.2

Result <span class="o">=</span> PASS

NOTE: The CUDA Samples are not meant <span class="k">for </span>performance measurements. Results may vary when GPU Boost is enabled.
</code></pre>
</div>


                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/11/25/firefox_PAC/" data-toggle="tooltip" data-placement="top" title="FireFox配置PAC">
                        上一篇<br>
                        <span>FireFox配置PAC</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/12/01/Android_Handler/" data-toggle="tooltip" data-placement="top" title="Android源码系列(4) -- Handler">
                        下一篇<br>
                        <span>Android源码系列(4) -- Handler</span>
                        </a>
                    </li>
                    
                </ul>

                
            </div>  

            <!-- Side Catalog Container -->
            
                <div class="
                    col-lg-2 col-lg-offset-0
                    visible-lg-block
                    sidebar-container
                    catalog-container">
                    <div class="side-catalog">
                        <hr class="hidden-sm hidden-xs">
                        <h5>
                            <a class="catalog-toggle" href="#">目录</a>
                        </h5>
                        <ul class="catalog-body"></ul>
                    </div>
                </div>
            

            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">标签</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#Tools" title="Tools" rel="3">Tools</a>
                            
        				
                            
                				<a href="/tags/#Java" title="Java" rel="4">Java</a>
                            
        				
                            
                				<a href="/tags/#Android源码系列" title="Android源码系列" rel="6">Android源码系列</a>
                            
        				
                            
                				<a href="/tags/#Python" title="Python" rel="3">Python</a>
                            
        				
                            
                				<a href="/tags/#Android" title="Android" rel="13">Android</a>
                            
        				
                            
                				<a href="/tags/#Java源码系列" title="Java源码系列" rel="4">Java源码系列</a>
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>友情链接</h5>
                <ul class="list-inline">
                    
                        <li><a href=""></a></li>
                    
                        <li><a href=""></a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

    <footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/phantomvk">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/phantomvk">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; phantomVK 2017 | Powered by Jekyll with Hux Theme
                </p>
            </div>
        </div>
    </div>
</footer>

<script src="/js/jquery.min.js "></script>
<script src="/js/bootstrap.min.js "></script>
<script src="/js/hux-blog.min.js "></script>

<script type="text/javascript">
    if(navigator.serviceWorker){
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>


<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<script>
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>

</body>
</html>