---
layout:     post
title:      "即时通讯头像理论"
date:       2019-05-19
author:     "phantomVK"
header-img: "img/bg/post_bg.jpg"
catalog:    true
tags:
    - business
---

## 前言

现在所有移动端应用，无论是新闻资讯、大众娱乐，还是即时通讯，充分利用人类是视觉动物的特点，通过大量的图片和视频强化用户对应用的依赖程度。继游戏之后，成为当今社会另一种名副其实的电子毒品。不过这里把研究的点限制在一个特定领域内，也就是主题所说的：即使通讯头像策略。

上面提及其他关于用户体验的领域研究，会考虑和另一位曾经任职网易的用户研究师合作出一些相关文章。

#### 二、类型划分

在即使通讯层面，头像包含两个类型：

- 个人头像
- 群头像
- 其他头像

#### 2.1 技术共性

先说说头像图片的技术共性。现在保存图片的类型主要为：__JPG__、__PNG__、__WEBP__。__JPG__ 是使用历史最长的有损图像压缩格式，体积也算小。

PNG相比JPG更大的优势应该是其无损压缩的能力，但是在缩略图加载的有损压缩用人眼几乎不能辨别的损失，换取更小的文件体积。所以此处PNG对比JPG并不占明显优势。

随后Google推出Webp，用比JPG更小的文件体积， 提供堪比PNG无损压缩的视觉质量。不过，Webp推荐时间较晚，也注定在部分应用或浏览器上存在兼容问题。不过考虑到其非一般的技术优越性，个人认为在浏览器兼容或移动端放弃部分旧终端，是完全值得的。

因此头像图像的文件格式保存上，不考虑兼容性等具体问题，技术选型的优先级如下：Webp>JPG>PNG。

这里提供一下其他的文章供参考：

[WebP 相对于 PNG、JPG 有什么优势？ - Hahn的回答 - 知乎](https://www.zhihu.com/question/27201061/answer/35637827)

[WebP原理和Android支持现状介绍](https://cloud.tencent.com/developer/article/1071597)

#### 2.2 个人头像

个人头像比较容易理解，就是好友自己设置的个性化的头像。个人头像具有比较鲜明的性格特点，能从个人头像的选图推断出好友的性格。只要七大姑八大姨不扯嘴皮子，几乎是爱用啥用啥。所以在业务层面，个人头像应该是应用图片加载内需求最简单的。

拿微信举例，在1920*1080 的Android上布局大小约为50dp\*50dp(推测)，所以在Android的xxhdpi的UI设计大小相当于150px\*150px，iOS的三倍图也是这个规格。

![avatar_1_grid](/img/business/avatar_images_compressing/avatar_1_grid.png)



因此个人图像的大小，完全就是UI布局的实际大小，并且不需要任何 __内边距__。

#### 2.3 群头像

群头像相比个人头像业务略显复杂，和个人头像最大的区别除了内嵌头像数量，还有最大的特点是具有内边距。群头像的排列具有四宫格、九宫格和群自定义类型三种。n宫格的具体头像组合，遵循群主优先或首位进入用户优先。

##### 2.3.1 四宫格头像

![avatars_4_grids](/img/business/avatar_images_compressing/avatars_4_grids.png)

##### 2.3.2 九宫格头像

![avatars_9_grids](/img/business/avatar_images_compressing/avatars_9_grids.png)

##### 2.3.3 群自定义类型

####  2.4 其他头像

其他头像的逻辑，应划分到非自然人头像，例如微信小程序的头像。和个人头像的逻辑没有具体差别，可以完全套用。

## 三、技术谈

HTTP缓存

图像加载及失效策略

群头像合成